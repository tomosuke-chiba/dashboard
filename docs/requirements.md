# 要件定義書

## プロジェクト概要

**プロジェクト名**: 求人媒体ダッシュボード
**クライアント**: 株式会社KOU
**作成日**: 2024年12月29日

---

## 1. 事業背景

### 1.1 株式会社KOUについて

| 項目 | 内容 |
|------|------|
| 会社名 | 株式会社KOU |
| 代表 | 千葉共将 |
| 事業内容 | 歯科医院向け採用支援サービス |
| サービス名 | SNS × 求人媒体 ハイブリッド採用支援サービス |

### 1.2 提供サービス

- **求人媒体運用代行**: 複数媒体出稿、競合リサーチ、スカウト、24時間対応
- **SNS動画運用**: Instagram / TikTok / YouTube Shorts / Threads / LINE VOOM の5媒体展開
- 現場訪問による動画撮影（50本/半年サイクル）

### 1.3 ターゲット顧客

- 歯科医院の院長（30代後半〜60代、男性85%）
- 主な悩み: 人手不足、求人対応の負担、採用体制構築

---

## 2. プロジェクト目的

### 2.1 解決したい課題

- 複数の求人媒体に都度ログインして情報確認する手間
- クライアントへの運用状況報告の効率化
- 新規応募の見逃し防止
- 運用データの可視化・履歴管理

### 2.2 ゴール

求人媒体のデータを自動取得し、社内・クライアント双方が確認できるダッシュボードを構築する。

---

## 3. 機能要件

### 3.1 データ取得機能

| 項目 | 要件 |
|------|------|
| 対象媒体（MVP） | GUPPY |
| 対象媒体（将来） | ジョブメドレー、Quacareer |
| 取得データ | PV数（閲覧数）、応募数 |
| 取得方法 | スクレイピング（ID + パスワード認証） |
| 更新頻度 | 10分に1回 |
| 認証方式 | GUPPYはID + パスワードのみ（2FA/CAPTCHAなし） |

### 3.2 ダッシュボード機能

#### クライアント向けページ

| 項目 | 要件 |
|------|------|
| URL形式 | `/clinic/[slug]` （クライアントごとの専用URL） |
| 認証 | なし（URLを知っていればアクセス可能） |
| 表示内容 | PV数、応募数、推移グラフ |
| デザイン | シンプル・機能優先 |

#### 社内管理ページ

| 項目 | 要件 |
|------|------|
| URL形式 | `/admin` |
| 認証 | 共有パスワード（1つのパスワードを社内で共有） |
| 表示内容 | 全クライアント一覧、各クライアントのPV・応募数、最終更新日時 |
| 機能 | 手動データ取得トリガー、各クライアント詳細ページへのリンク |

### 3.3 通知機能

| 項目 | 要件 |
|------|------|
| 通知先 | Discord（Webhook） |
| 通知チャンネル | 1つのチャンネルに全クライアント分をまとめる |
| 通知タイミング | 新規応募があった時 |
| 通知内容 | 最低限（クライアント名 + 「新規応募あり」） |
| Webhook | 準備済み |

### 3.4 データ保存機能

| 項目 | 要件 |
|------|------|
| 履歴保存 | あり（推移グラフ表示のため） |
| 保存期間 | 1年分以上 |
| 集計単位 | 日別 |

---

## 4. 非機能要件

### 4.1 クライアント管理

| 項目 | 要件 |
|------|------|
| クライアント数 | 11件以上 |
| アカウント管理 | クライアントごとに求人媒体アカウントが別々 |
| ログイン情報管理 | KOUで一括管理 |
| クライアント追加方法 | 設定ファイル/DB直接編集（MVP） |

### 4.2 運用コスト

| 項目 | 要件 |
|------|------|
| 予算 | 月1万円以上でも可 |

### 4.3 期限

| 項目 | 要件 |
|------|------|
| MVP完成 | 1〜2週間以内 |
| 初期テスト | 1〜2件のクライアントで稼働確認 |

---

## 5. 技術要件

### 5.1 技術スタック（提案）

| レイヤー | 技術 | 理由 |
|----------|------|------|
| フロントエンド | Next.js + Tailwind CSS | 高速開発、シンプルなUI構築 |
| バックエンド | Next.js API Routes | フロントと統合、別サーバー不要 |
| スクレイピング | Playwright | ログイン必要なサイトに強い |
| データベース | Supabase (PostgreSQL) | 無料枠あり、簡単セットアップ |
| 定期実行 | Vercel Cron / GitHub Actions | 10分ごとの実行 |
| ホスティング | Vercel | 無料枠あり、簡単デプロイ |
| 通知 | Discord Webhook | 準備済み |

### 5.2 環境

| 項目 | 内容 |
|------|------|
| 既存コード | なし（新規作成） |
| サーバー | おすすめに従う（Vercel提案） |

---

## 6. MVP スコープ

### 6.1 MVP に含める機能

- [x] GUPPYからのデータ取得（PV + 応募数）
- [x] クライアント別ダッシュボード（専用URL）
- [x] 社内管理ページ（パスワード認証）
- [x] Discord通知（新規応募時）
- [x] 履歴データ保存・グラフ表示
- [x] 10分ごとの自動更新

### 6.2 MVP 後に追加する機能

- [ ] ジョブメドレー対応
- [ ] Quacareer対応
- [ ] 応募者一覧表示
- [ ] 求人の掲載順位表示
- [ ] 管理画面からのクライアント追加機能（GUI）

---

## 7. データベース設計（案）

### 7.1 テーブル構成

#### clinics（クライアント情報）

| カラム | 型 | 説明 |
|--------|-----|------|
| id | UUID | 主キー |
| name | TEXT | クライアント名（歯科医院名） |
| slug | TEXT | URL用スラッグ（ユニーク） |
| guppy_login_id | TEXT | GUPPYログインID |
| guppy_password | TEXT | GUPPYパスワード |
| created_at | TIMESTAMP | 作成日時 |
| updated_at | TIMESTAMP | 更新日時 |

#### metrics（メトリクスデータ）

| カラム | 型 | 説明 |
|--------|-----|------|
| id | UUID | 主キー |
| clinic_id | UUID | クライアントID（外部キー） |
| pv_count | INTEGER | PV数 |
| application_count | INTEGER | 応募数 |
| recorded_at | TIMESTAMP | 記録日時 |

---

## 8. 画面構成

```
/                    → トップページ（リダイレクトまたは案内）
/admin               → 社内管理ページ（パスワード認証）
/clinic/[slug]       → クライアント別ダッシュボード
/api/scrape          → スクレイピング実行API
/api/clinics         → クライアント一覧API
/api/clinics/[slug]  → クライアント詳細API
```

---

## 9. 注意事項・リスク

### 9.1 スクレイピングに関するリスク

- 求人媒体の利用規約に抵触する可能性
- 媒体側の仕様変更によりメンテナンスが必要になる可能性
- ログインセッションの管理

### 9.2 対策

- 過度なアクセス頻度を避ける（10分間隔）
- エラー発生時のアラート設定
- 定期的な動作確認

---

## 10. 今後の拡張案

1. **複数媒体対応**: ジョブメドレー、Quacareer
2. **詳細データ**: 応募者一覧、求人掲載順位
3. **レポート機能**: PDF出力、月次サマリー
4. **アラート拡張**: 特定条件でのカスタム通知
5. **クライアント管理GUI**: 管理画面からのクライアント追加・編集

---

## 変更履歴

| 日付 | 内容 |
|------|------|
| 2024-12-29 | 初版作成 |
